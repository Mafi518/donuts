const disableScroll = function() {
    let paddingOffset = window.innerWidth - document.body.offsetWidth + 'px'
    document.body.classList.toggle('scroll-lock')
    document.body.style.paddingRight = paddingOffset
}

const burger = document.querySelector('.menu-icon').addEventListener('click', function() {
    const menu = document.querySelector('.menu')
    const secondMenu = document.querySelector('.second-menu')
    this.classList.toggle('menu-icon__active')
    menu.classList.toggle('menu__active')
    secondMenu.classList.toggle('menu__active-second')
    disableScroll()

    let links = document.querySelectorAll('.menu__link').forEach(element => {
        element.onclick = () => {
            menu.classList.toggle('menu__active')
            this.classList.toggle('menu-icon__active')
            secondMenu.classList.toggle('menu__active-second')
            disableScroll()
        }
    })
})

let buy = document.querySelector('.set__sumbit-button').addEventListener('click', e => {
    e.preventDefault
    const popup = document.querySelector('.success')
    const exit = document.querySelector('.success__exit')
    const bg = document.querySelector('.success__bg')
    

    popup.classList.add('success__active')
    bg.classList.add('success__bg-active')


    exit.addEventListener('click', elem => {
        popup.classList.remove('success__active')
        bg.classList.remove('success__bg-active')
    })
    bg.addEventListener('click', elem => {
        popup.classList.remove('success__active')
        bg.classList.remove('success__bg-active')
    })

    console.log(inp);
})

const quantity = document.querySelectorAll('.quantity__button').forEach(
    (btn) => {
        btn.addEventListener('click', function() {
            const direction = this.dataset.direction
            const inp = this.parentElement
            .querySelector('.quantity')
            const currentValue = +inp.value
            const clouserePrice = this.parentElement.parentElement.querySelector('.hidden__price')
            const price = this.parentElement.parentElement.querySelector('.current__price')
            let newValue
            let newPrice

            if (direction === 'plus') {
                newValue = currentValue + 1 < 99 ? currentValue + 1 : 99
            } else {
                newValue = currentValue - 1 > 0 ? currentValue - 1 : 0
            }

            inp.value = newValue
            newPrice = clouserePrice.textContent * newValue
            price.textContent = newPrice + ' '


        })
    }
)

const basket = document.querySelectorAll('.set__button').forEach(
    (btn) => {
        btn.addEventListener('click', function() {
            const basket = document.querySelector('.basket')
            
            const name = this.parentElement.querySelector('.set__name').innerHTML
            
            const quantity = this.parentElement.querySelector('.quantity').value

            const price = this.parentElement.querySelector('.current__price').innerHTML + 'руб.'

            const image = this.parentElement.parentElement.querySelector('.set__image img').getAttribute('src')

            console.log(image, name, price, quantity);

            const basketImage = document.querySelector('.basket__image')
            const basketName = document.querySelector('.basket__item-title')
            const basketQuantity = document.querySelector('.basket__item-quantity')
            const basketPrice = document.querySelector('.basket__item-price')

            if (quantity >= 1) {
                basketImage.src = image
                basketName.value = name
                basketQuantity.value = 'Количество: ' + quantity
                basketPrice.value = 'Сумма заказа: ' + price

                basket.classList.add('basket__active')
            } else {
            }



        })
    }
)

const currentCard = document.querySelectorAll('.set__item').forEach(
    (cards) => {
        cards.addEventListener('click', function() {

            const image = this.querySelector('.set__image img').src
            const name = this.querySelector('.set__name').innerHTML
            const price = this.querySelector('.set__price').innerHTML


        })
    }
)


$(document).ready(function(){
    $('.feedback__list').slick({
        slidesToShow: 3,
        slidesToScroll: 1,
        arrows: false,
        dots: true,
        responsive: [
            {
                breakpoint: 421,
                settings: {
                    slidesToShow: 1
                }
            }
        ]
    });
});